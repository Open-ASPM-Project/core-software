from app.modules.secrets.model.secrets_model import SeverityLevel
import re


severity_map = {
    SeverityLevel.CRITICAL: [
        "AWS",
        "Azure",
        "GCP",
        "PrivateKey",
        "Firebase",
        "KubeConfig",
        "Auth0oauth",
        "CloudflareGlobalApiKey",
        "CloudflareCaKey",
        "GoogleOauth2",
        "ReCAPTCHA",
        "GoogleApiKey",
        "PlaidToken",
        "PlaidKey",
        "SentryToken",
        "TerraformCloudPersonalToken",
        "Auth0ManagementApiToken",
        "GitHubOld",
        "AdobeIO",
        "OpenAI",
        "Stripe",
        "PaypalOauth",
        "PagerDutyApiKey",
        "GitHubApp",
        "CircleCI",
        "DatadogToken",
        "FacebookOAuth",
        "TwitterApiSecret",
        "DiscordBotToken",
        "SlackWebhook",
        "TwilioAuthToken",
        "SendGridApiKey",
        "MailgunApiKey",
        "AWSSessionToken",
        "AzureActiveDirectoryApplicationSecret",
        "AzureCacheForRedisAccessKey",
        "AzureCosmosDBKeyIdentifiable",
        "AzureDevopsPersonalAccessToken",
        "AzureFunctionKey",
        "AzureMLWebServiceClassicIdentifiableKey",
        "AzureSasToken",
        "AzureSearchAdminKey",
        "AzureSearchQueryKey",
        "AzureManagementCertificate",
        "AzureSQL",
        "GCPApplicationDefaultCredentials",
        "DigitalOceanToken",
        "HerokuApiKey",
        "DockerHubAccessToken",
        "BitbucketServerPersonalAccessToken",
        "JFrogArtifactoryApiKey",
        "NpmAuthToken",
        "PyPiUploadToken",
        "RubyGemsApiKey",
        "TravisciAccessToken",
        "CircleCIApiToken",
        "JenkinsApiToken",
        "TeamCityPassword",
        "SonarQubeToken",
        "NexusRepositoryManagerApiToken",
        "ArtifactoryApiKey",
        "DockerRegistryPassword",
        "KubernetesConfigFile",
        "TerraformEnterpriseApiToken",
        "VaultToken",
        "ConsulHttpToken",
        "NomadApiToken",
        "PulsarToken",
        "CassandraPassword",
        "MongoDbPassword",
        "MySqlPassword",
        "PostgreSqlPassword",
        "RedisPassword",
        "ElasticsearchPassword",
        "Neo4jPassword",
        "InfluxDbToken",
        "GrafanaApiKey",
        "PrometheusApiToken",
        "DatadogApiKey",
        "NewRelicApiKey",
        "PagerDutyApiToken",
        "OpsGenieApiKey",
        "SlackBotToken",
        "DiscordWebhookUrl",
        "MattermostWebhookUrl",
        "RocketchatWebhookUrl",
        "TeamsWebhookUrl",
        "TwilioAccountSid",
        "SendgridApiKey",
        "MailgunApiKey",
        "PostmarkServerToken",
        "AwsAccessKeyId",
        "AwsSecretAccessKey",
        "AzureStorageAccountKey",
        "GoogleCloudStorageAccessKey",
        "DropboxAccessToken",
        "BoxEnterpriseApiKey",
        "Shopify",
        "Salesforce",
        "HuggingFace",
        "Snowflake",
        "Sourcegraph",
        "Tailscale",
        "Web3Storage",
        "AzureStorage",
        "PlanetScaleDb",
        "Anthropic",
        "Ramp",
        "Klaviyo",
        "SourcegraphCody",
        "Voiceflow",
        "Privacy",
        "aws-access-token",
        "github-oauth",
        "github-pat",
        "github-fine-grained-pat",
        "gitlab-pat",
        "private-key",
        "kubernetes-secret-yaml",
        "openai-api-key",
        "stripe-access-token",
        "twilio-api-key",
        "sendgrid-api-token",
        "vault-service-token"],
    SeverityLevel.HIGH: [
        "Alibaba",
        "AMQP",
        "Coinbase",
        "Generic",
        "Github",
        "Gitlab",
        "JDBC",
        "RazorPay",
        "SendGrid",
        "Slack",
        "Square",
        "URI",
        "Dropbox",
        "Mailchimp",
        "Okta",
        "OneLogin",
        "PivotalTracker",
        "SquareApp",
        "Twilio",
        "TravisCI",
        "Mailgun",
        "HubSpot",
        "WpEngine",
        "AsanaPersonalAccessToken",
        "AmplitudeApiKey",
        "BitLyAccessToken",
        "CalendlyApiKey",
        "ZapierWebhook",
        "YoutubeApiKey",
        "SalesforceOauth2",
        "NpmToken",
        "NewRelicPersonalApiKey",
        "AirtableApiKey",
        "AkamaiToken",
        "AmazonMWS",
        "Bitfinex",
        "Clarifai",
        "Confluent",
        "ContentfulDelivery",
        "DatabricksToken",
        "DigitalOceanSpaces",
        "EtsyApiKey",
        "FastlyPersonalToken",
        "Hunter",
        "IbmCloudUserKey",
        "Netlify",
        "Vonage",
        "EquinixOauth",
        "Paystack",
        "Plivo",
        "Postmark",
        "PubNubPublishKey",
        "PubNubSubscriptionKey",
        "PusherChannelKey",
        "ScalewayKey",
        "SendinBlueV2",
        "ShodanKey",
        "SnykKey",
        "SpotifyKey",
        "TelegramBotToken",
        "TencentCloudKey",
        "TrelloApiKey",
        "ZendeskApi",
        "MaxMindLicense",
        "AirtableMetadataApiKey",
        "AsanaOauth",
        "RapidApi",
        "CloudflareApiToken",
        "Webex",
        "FirebaseCloudMessaging",
        "ContentfulPersonalAccessToken",
        "MapBox",
        "MailJetBasicAuth",
        "MailJetSMS",
        "HubSpotApiKey",
        "HubSpotOauth",
        "SslMate",
        "MessageBird",
        "ElasticEmail",
        "FigmaPersonalAccessToken",
        "MicrosoftTeamsWebhook",
        "VultrApiKey",
        "Pepipost",
        "Postman",
        "CloudsightKey",
        "JiraToken",
        "NexmoApiKey",
        "SegmentApiKey",
        "SumoLogicKey",
        "PushBulletApiKey",
        "AirbrakeProjectKey",
        "AirbrakeUserKey",
        "PendoIntegrationKey",
        "SplunkOberservabilityToken",
        "LokaliseToken",
        "Calendarific",
        "Jumpcloud",
        "IpStack",
        "Notion",
        "DroneCI",
        "TwelveData",
        "D7Network",
        "ScrapingBee",
        "KeenIO",
        "Wakatime",
        "Buildkite",
        "Verimail",
        "Zerobounce",
        "Mailboxlayer",
        "Fastspring",
        "Paddle",
        "Sellfy",
        "FixerIO",
        "ButterCMS",
        "Taxjar",
        "Avalara",
        "Helpscout",
        "ElasticPath",
        "Zeplin",
        "Intercom",
        "Mailmodo",
        "CannyIo",
        "Pipedrive",
        "Vercel",
        "PosthogApp",
        "SinchMessage",
        "Ayrshare",
        "HelpCrunch",
        "LiveAgent",
        "Beamer",
        "WeChatAppKey",
        "LineMessaging",
        "UberServerToken",
        "AlgoliaAdminKey",
        "FullContact",
        "Mandrill",
        "Flutterwave",
        "MattermostPersonalToken",
        "Cloudant",
        "LineNotify",
        "LinearAPI",
        "Ubidots",
        "Anypoint",
        "Dwolla",
        "ArtifactoryAccessToken",
        "Surge",
        "Sparkpost",
        "GoCardless",
        "Codacy",
        "Kraken",
        "Checkout",
        "Kairos",
        "ClockworkSMS",
        "Atlassian",
        "LaunchDarkly",
        "Coveralls",
        "Linode",
        "WePay",
        "PlanetScale",
        "Doppler",
        "Agora",
        "Samsara",
        "FrameIO",
        "RubyGems",
        "SurveySparrow",
        "Simvoly",
        "Survicate",
        "Omnisend",
        "Groovehq",
        "Newsapi",
        "Chatbot",
        "ClickSendsms",
        "Getgist",
        "CustomerIO",
        "ApiDeck",
        "Nftport",
        "Copper",
        "Close",
        "Myfreshworks",
        "Salesflare",
        "Webflow",
        "Duda",
        "Yext",
        "ContentStack",
        "Storyblok",
        "GraphCMS",
        "Checkmarket",
        "Convertkit",
        "CustomerGuru",
        "Kaleyra",
        "Mailerlite",
        "Qualaroo",
        "SatismeterProjectkey",
        "SatismeterWritekey",
        "Simplesat",
        "SurveyAnyplace",
        "SurveyBot",
        "Webengage",
        "ZonkaFeedback",
        "Delighted",
        "Feedier",
        "Abbysale",
        "Magnetic",
        "Nytimes",
        "Polygon",
        "Powrbot",
        "ProspectIO",
        "Skrappio",
        "Monday",
        "Smartsheets",
        "Wrike",
        "Float",
        "Imagekit",
        "Integromat",
        "Salesblink",
        "Bored",
        "Campayn",
        "Clinchpad",
        "CompanyHub",
        "Debounce",
        "Dyspatch",
        "Guardianapi",
        "Harvest",
        "Moosend",
        "OpenWeather",
        "Siteleaf",
        "Squarespace",
        "FlowFlu",
        "Nimble",
        "LessAnnoyingCRM",
        "Nethunt",
        "Apptivo",
        "CapsuleCRM",
        "Insightly",
        "Kylas",
        "OnepageCRM",
        "User",
        "ProspectCRM",
        "ReallySimpleSystems",
        "Airship",
        "Artsy",
        "Yandex",
        "Clockify",
        "Dnscheck",
        "EasyInsight",
        "Ethplorer",
        "Everhour",
        "Fulcrum",
        "GeoIpifi",
        "Jotform",
        "Refiner",
        "Timezoneapi",
        "TogglTrack",
        "Vpnapi",
        "Workstack",
        "Apollo",
        "Eversign",
        "Juro",
        "KarmaCRM",
        "Metrilo",
        "Pandadoc",
        "RevampCRM",
        "Salescookie",
        "Alconost",
        "Blogger",
        "Accuweather",
        "Ayden",
        "Printful",
        "SurveyCTO",
        "Pexels",
        "IP2Location",
        "Ipinfo",
        "Personio",
        "Docusign",
        "cloudflare-api-key",
        "cloudflare-global-api-key",
        "databricks-api-token",
        "discord-api-token",
        "heroku-api-key",
        "jwt",
        "jwt-base64",
        "age-secret-key",
        "alibaba-secret-key",
        "confluence-access-token",
        "datadog-access-token",
        "digitalocean-access-token",
        "digitalocean-pat",
        "dropbox-api-token",
        "facebook-access-token",
        "facebook-secret",
        "gcp-api-key",
        "github-app-token",
        "gitlab-ptt",
        "gitlab-rrt",
        "hashicorp-tf-api-token",
        "hashicorp-tf-password",
        "mailchimp-api-key",
        "mailgun-private-api-token",
        "new-relic-user-api-key",
        "npm-access-token",
        "okta-access-token",
        "plaid-secret-key",
        "pypi-upload-token",
        "slack-bot-token",
        "slack-user-token",
        "twitter-access-secret",
        "twitter-api-secret"],
    SeverityLevel.MEDIUM: [
        "Circle",
        "Test",
        "Spoonacular",
        "Aerisweather",
        "Alphavantage",
        "Ipregistry",
        "M3O",
        "MapTiler",
        "Merriam",
        "OpenExchangeRates",
        "OpenCage",
        "RestCountries",
        "Trafiklab",
        "WeatherStack",
        "Giphy",
        "IPData",
        "BitIo",
        "Twizo",
        "CheetahO",
        "Webpushr",
        "Octoparse",
        "Timezonedb",
        "Zomato",
        "Browshot",
        "IPGeolocation",
        "Owlbot",
        "HolidayAPI",
        "Nutritionix",
        "Typeform",
        "Lastfm",
        "SunriseSunset",
        "Smspartner",
        "Currents",
        "PostcodesIO",
        "Currencylayer",
        "Iana",
        "Scrapestack",
        "Foursquare",
        "ClickHelp",
        "Rebrandly",
        "Wunderlist",
        "Syncfusion",
        "Imageflip",
        "Boxmode",
        "Randommer",
        "Reverso",
        "RestdbIO",
        "SinchSms",
        "WebinarJam",
        "Zebra",
        "ICanHazIp",
        "Gravatar",
        "Cumulocity",
        "Coincap",
        "Binance",
        "Nager",
        "Ipify",
        "Ipwhois",
        "Bigml",
        "Quickchart",
        "Advicely",
        "AnyClip",
        "Appwrite",
        "Freegeoip",
        "Placid",
        "Coinpaprika",
        "Iplocate",
        "OpenAIKey",
        "Scraper",
        "Unavatar",
        "Weatherapi",
        "Currencyapi",
        "Zenserp",
        "Imagebb",
        "Bytesview",
        "Gumroad",
        "Neutrinoapi",
        "Frost",
        "Cloudinary",
        "Doodle",
        "Metype",
        "Moderatecontent",
        "Sendoso",
        "PexelsApiKey",
        "Mollie",
        "CoinMarketCap",
        "Adviceslip",
        "Sheetdb",
        "RiotGames",
        "TwitchClient",
        "WebexToken",
        "OpenWeatherApiKey",
        "OpenLibrary",
        "MerriamWebster",
        "DictionaryApi",
        "DarkSky",
        "FixerIo",
        "Abstract",
        "FixerAPI",
        "FunTranslations",
        "Isup",
        "LetsApi",
        "SmsApi",
        "Abstractapi",
        "RestApiTutorial",
        "ZebraApi",
        "Shutterstock",
        "WeatherUnfold",
        "WebMonetizationToken",
        "Mqtt",
        "Macaddress",
        "Uclassify",
        "Pikwy",
        "WeatherAPI",
        "adobe-client-secret",
        "asana-client-secret",
        "atlassian-api-token",
        "bitbucket-client-secret",
        "bittrex-secret-key",
        "codecov-access-token",
        "confluent-secret-key",
        "discord-client-secret",
        "doppler-api-token",
        "fastly-api-token",
        "finnhub-access-token",
        "flutterwave-secret-key",
        "generic-api-key",
        "grafana-api-key",
        "hubspot-api-key",
        "jfrog-api-key",
        "jfrog-identity-token",
        "kraken-access-token",
        "kucoin-secret-key",
        "linkedin-client-secret",
        "planetscale-password",
        "sendbird-access-token",
        "shopify-private-app-access-token",
        "shopify-shared-secret",
        "sidekiq-secret",
        "snyk-api-token",
        "square-access-token",
        "sumologic-access-token",
        "vault-batch-token",
        "zendesk-secret-key"],
    SeverityLevel.LOW: [
        "adafruit-api-key",
        "airtable-api-key",
        "algolia-api-key",
        "alibaba-access-key-id",
        "asana-client-id",
        "authress-service-client-access-key",
        "beamer-api-token",
        "bitbucket-client-id",
        "bittrex-access-key",
        "clojars-api-token",
        "cloudflare-origin-ca-key",
        "coinbase-access-token",
        "confluent-access-token",
        "contentful-delivery-api-token",
        "defined-networking-api-token",
        "digitalocean-refresh-token",
        "discord-client-id",
        "droneci-access-token",
        "dropbox-long-lived-api-token",
        "dropbox-short-lived-api-token",
        "duffel-api-token",
        "dynatrace-api-token",
        "easypost-api-token",
        "easypost-test-api-token",
        "etsy-access-token",
        "facebook-page-access-token",
        "finicity-api-token",
        "finicity-client-secret",
        "flickr-access-token",
        "flutterwave-encryption-key",
        "flutterwave-public-key",
        "flyio-access-token",
        "frameio-api-token",
        "freshbooks-access-token",
        "github-refresh-token",
        "gitter-access-token",
        "gocardless-api-token",
        "grafana-cloud-api-token",
        "grafana-service-account-token",
        "harness-api-key",
        "huggingface-access-token",
        "huggingface-organization-api-token",
        "infracost-api-token",
        "intercom-api-key",
        "intra42-client-secret",
        "launchdarkly-access-token",
        "linear-api-key",
        "linear-client-secret",
        "lob-api-key",
        "lob-pub-api-key",
        "mailgun-pub-key",
        "mailgun-signing-key",
        "mapbox-api-token",
        "mattermost-access-token",
        "messagebird-api-token",
        "messagebird-client-id",
        "netlify-access-token",
        "new-relic-browser-api-token",
        "new-relic-insert-key",
        "new-relic-user-api-id",
        "nytimes-access-token",
        "plaid-api-token",
        "plaid-client-id",
        "planetscale-api-token",
        "planetscale-oauth-token",
        "postman-api-token",
        "prefect-api-token",
        "pulumi-api-token",
        "rapidapi-access-token",
        "readme-api-token",
        "rubygems-api-token",
        "scalingo-api-token",
        "sendbird-access-id",
        "sentry-access-token",
        "shippo-api-token",
        "shopify-access-token",
        "shopify-custom-access-token",
        "sidekiq-sensitive-url",
        "slack-app-token",
        "typeform-api-token",
        "twitter-access-token",
        "twitter-api-key",
        "twitter-bearer-token",
        "yandex-access-token",
        "yandex-api-key",
        "yandex-aws-access-token"],
    SeverityLevel.INFORMATION: [
        "adobe-client-id",
        "linkedin-client-id",
        "microsoft-teams-webhook"]}


def convert_case(string: str) -> str:
    if '-' in string:
        return re.sub(r'-(\w)', lambda match: match.group(1).upper(), string)
    else:
        return re.sub(r'([a-z0-9])([A-Z])', r'\1-\2', string).lower()


def mark_severity(key_name: str) -> SeverityLevel:
    key_name = convert_case(key_name).lower()

    for severity, keys in severity_map.items():
        converted_keys = [convert_case(key).lower() for key in keys]
        if key_name in converted_keys:
            return severity
    return SeverityLevel.UNKNOWN
