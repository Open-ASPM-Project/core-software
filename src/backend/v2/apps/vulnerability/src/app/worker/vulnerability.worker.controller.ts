import { Controller, Post, Body } from '@nestjs/common';
import { VulnerabilityWorker } from './vulnerability.worker';
import { AssetEventData } from '@firewall-backend/dto';

@Controller('vulnerability-worker')
export class VulnerabilityWorkerController {
  constructor(private readonly vulnerabilityWorker: VulnerabilityWorker) {}

  @Post('scan')
  async triggerScan(@Body() body: AssetEventData) {
    await this.vulnerabilityWorker.pushToQueue(body);
    return { message: 'Scan request sent to queue' };
  }
}
